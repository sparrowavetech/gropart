(()=>{function e(o){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(o)}!function(o){o.fn.filetree=function(t){var r={animationSpeed:"slow",console:!1};if("object"==e(t)||!t)return function(e){return e=o.extend(r,e),this.each((function(){o(this).find("li").on("click",".file-opener-i",(function(e){return e.preventDefault(),o(this).hasClass("fa-plus-square")?(o(this).addClass("fa-minus-square"),o(this).removeClass("fa-plus-square")):(o(this).addClass("fa-plus-square"),o(this).removeClass("fa-minus-square")),o(this).parent().toggleClass("closed").toggleClass("open"),!1}))}))}.apply(this,arguments)}}(jQuery),function(o){o.fn.dragScroll=function(t){if("object"==e(t)||!t)return function(){var e,r,a=o(this),n=o.extend({scrollVertical:!1,scrollHorizontal:!0,cursor:null},t),l=!1;a.on({mousemove:function(t){l&&function(t,a){var l=o(a);n.scrollVertical&&l.scrollTop(l.scrollTop()+(e-t.pageY)),n.scrollHorizontal&&l.scrollLeft(l.scrollLeft()+(r-t.pageX))}(t,this)},mousedown:function(o){a.css("cursor",n.cursor?n.cursor:n.scrollVertical&&n.scrollHorizontal?"move":n.scrollVertical?"row-resize":n.scrollHorizontal?"col-resize":void 0),l=!0,e=o.pageY,r=o.pageX},mouseup:function(){l=!1,a.css("cursor","auto")},mouseleave:function(){l=!1,a.css("cursor","auto")}})}.apply(this,arguments)}}(jQuery),$((function(){var e=$(".file-tree-wrapper");e.dragScroll();var o=$(".tree-form-container").find(".tree-loading"),t=$(".tree-categories-container").find(".tree-loading");function r(o){t.removeClass("d-none"),e.filetree().removeClass("d-none").hide().slideDown("slow"),t.addClass("d-none"),o&&e.find('li[data-id="'+o+'"] .category-name:first').addClass("active")}function a(e){$(".tree-form-body").html(e),Botble.initResources(),Botble.handleCounterUp(),window.EditorManagement&&(window.EDITOR=(new EditorManagement).init()),Botble.initMediaIntegrate()}function n(t,r){var n;(n=$.ajaxSetup().data)&&(delete n.ref_from,delete n.ref_lang),$.ajax({url:t,type:"GET",beforeSend:function(){o.removeClass("d-none"),e.find("a.active").removeClass("active"),r&&r.addClass("active")},success:function(e){e.error?Botble.showError(e.message):a(e.data)},error:function(e){Botble.handleError(e)},complete:function(){o.addClass("d-none")}})}r(),$(document).on("click",".tree-categories-container .toggle-tree",(function(e){var o=$(e.currentTarget),t=$(".tree-categories-container");o.hasClass("open-tree")?(o.text(o.data("collapse")),t.find(".folder-root.closed").removeClass("closed").addClass("open")):(o.text(o.data("expand")),t.find(".folder-root.open").removeClass("open").addClass("closed")),o.toggleClass("open-tree")})),e.on("click",".fetch-data",(function(o){o.preventDefault();var t=$(o.currentTarget);t.attr("href")?n(t.attr("href"),t):(e.find("a.active").removeClass("active"),t.addClass("active"))})),$(document).on("click",".tree-categories-create",(function(e){e.preventDefault(),function(e){var t={};l.get("ref_lang")&&(t.ref_lang=l.get("ref_lang"));$.ajax({url:e,type:"GET",data:t,beforeSend:function(){o.removeClass("d-none")},success:function(e){e.error?Botble.showError(e.message):a(e.data)},error:function(e){Botble.handleError(e)},complete:function(){o.addClass("d-none")}})}($(e.currentTarget).attr("href"))}));var l=new URLSearchParams(window.location.search);function s(o,t){$.ajax({url:e.data("url"),type:"GET",success:function(a){a.error?Botble.showError(a.message):(e.html(a.data),r(o),jQuery().tooltip&&$('[data-bs-toggle="tooltip"]').tooltip({placement:"top",boundary:"window"}),t&&t())},error:function(e){Botble.handleError(e)}})}$(document).on("click","#list-others-language a",(function(e){e.preventDefault(),n($(e.currentTarget).prop("href"))})),$(document).on("submit",".tree-form-container form",(function(e){var t;e.preventDefault();var r=$(e.currentTarget),n=r.serializeArray(),l=null===(t=e.originalEvent)||void 0===t?void 0:t.submitter,i=!1;l&&l.name&&(i="apply"===l.value,n.push({name:l.name,value:l.value})),$.ajax({url:r.attr("action"),type:r.attr("method")||"POST",data:n,beforeSend:function(){o.removeClass("d-none")},success:function(e){if(e.error)Botble.showError(e.message);else{Botble.showSuccess(e.message),o.addClass("d-none");var t=$(".tree-categories-create"),r=i&&e.data.model?e.data.model.id:null;s(r,(function(){if(r){var n=$('.folder-root[data-id="'+r+'"] > a.fetch-data');n.length?n.trigger("click"):location.reload()}else if(t.length)t.trigger("click");else{var l;a(null===(l=e.data)||void 0===l?void 0:l.form),o.addClass("d-none")}}))}},error:function(e){Botble.handleError(e),o.addClass("d-none")}})})),$(document).on("click",".deleteDialog",(function(e){e.preventDefault();var o=$(e.currentTarget);$(".delete-crud-entry").data("section",o.data("section")),$(".modal-confirm-delete").modal("show")})),$(".delete-crud-entry").on("click",(function(e){e.preventDefault();var o=$(e.currentTarget);o.addClass("button-loading");var t=o.data("section");$.ajax({url:t,type:"POST",data:{_method:"DELETE"},success:function(e){if(e.error)Botble.showError(e.message);else{Botble.showSuccess(e.message),s();var t=$(".tree-categories-create");t.length?t.trigger("click"):a("")}o.closest(".modal").modal("hide"),o.removeClass("button-loading")},error:function(e){Botble.handleError(e),o.removeClass("button-loading")}})}))}))})();